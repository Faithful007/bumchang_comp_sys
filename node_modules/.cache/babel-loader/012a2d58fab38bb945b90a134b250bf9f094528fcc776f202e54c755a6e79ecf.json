{"ast":null,"code":"// src/modules/fivSpeedGrade/fivHelpers.js\nimport pmFiv from \"../../data/pmSpeedGraceFiv.json\";\n\n// Map “a–d” groups to JSON vehicle_classes keys\nexport const PM_FIV_GROUPS = [{\n  id: \"a\",\n  jsonKey: \"gasoline_passenger\",\n  labelKo: \"a) 휘발유 승용차\"\n}, {\n  id: \"b\",\n  jsonKey: \"diesel_passenger\",\n  labelKo: \"b) 경유 승용차\"\n}, {\n  id: \"c\",\n  jsonKey: \"small_bus_truck\",\n  labelKo: \"c) 소형버스, 소형트럭\"\n}, {\n  id: \"d\",\n  jsonKey: \"large_bus_and_heavy_truck\",\n  labelKo: \"d) 대형버스, 중형·대형·특수트럭\"\n}];\nconst speeds = pmFiv.metadata.speeds_kmh; // [0,10,20,...]\nconst grades = pmFiv.metadata.grades_percent; // [-6..+6]\n\nfunction nearestIndex(arr, value) {\n  const v = Number(value);\n  if (!Number.isFinite(v)) return 0;\n  let bestIdx = 0;\n  let bestDist = Infinity;\n  arr.forEach((a, i) => {\n    const d = Math.abs(a - v);\n    if (d < bestDist) {\n      bestDist = d;\n      bestIdx = i;\n    }\n  });\n  return bestIdx;\n}\n\n/**\r\n * Look up f_iv for PM using nearest neighbour in the table.\r\n *\r\n * @param {string} vehicleClassKey - one of pmFiv.vehicle_classes keys\r\n * @param {number} speedKmh        - speed in km/h\r\n * @param {number} gradePercent    - longitudinal grade in %\r\n */\nexport function getFivPM(vehicleClassKey, speedKmh, gradePercent) {\n  const cls = pmFiv.vehicle_classes[vehicleClassKey];\n  if (!cls) {\n    throw new Error(`Unknown PM vehicle class key: ${vehicleClassKey}`);\n  }\n  const r = nearestIndex(speeds, speedKmh);\n  const c = nearestIndex(grades, gradePercent);\n  return cls.fiv_table[r][c];\n}","map":{"version":3,"names":["pmFiv","PM_FIV_GROUPS","id","jsonKey","labelKo","speeds","metadata","speeds_kmh","grades","grades_percent","nearestIndex","arr","value","v","Number","isFinite","bestIdx","bestDist","Infinity","forEach","a","i","d","Math","abs","getFivPM","vehicleClassKey","speedKmh","gradePercent","cls","vehicle_classes","Error","r","c","fiv_table"],"sources":["C:/Users/USER/sourcecodes/auto-excel/comp-engine2/src/modules/fivSpeedGrade/fivHelpers.js"],"sourcesContent":["// src/modules/fivSpeedGrade/fivHelpers.js\r\nimport pmFiv from \"../../data/pmSpeedGraceFiv.json\";\r\n\r\n// Map “a–d” groups to JSON vehicle_classes keys\r\nexport const PM_FIV_GROUPS = [\r\n  {\r\n    id: \"a\",\r\n    jsonKey: \"gasoline_passenger\",\r\n    labelKo: \"a) 휘발유 승용차\"\r\n  },\r\n  {\r\n    id: \"b\",\r\n    jsonKey: \"diesel_passenger\",\r\n    labelKo: \"b) 경유 승용차\"\r\n  },\r\n  {\r\n    id: \"c\",\r\n    jsonKey: \"small_bus_truck\",\r\n    labelKo: \"c) 소형버스, 소형트럭\"\r\n  },\r\n  {\r\n    id: \"d\",\r\n    jsonKey: \"large_bus_and_heavy_truck\",\r\n    labelKo: \"d) 대형버스, 중형·대형·특수트럭\"\r\n  }\r\n];\r\n\r\nconst speeds = pmFiv.metadata.speeds_kmh;         // [0,10,20,...]\r\nconst grades = pmFiv.metadata.grades_percent;     // [-6..+6]\r\n\r\nfunction nearestIndex(arr, value) {\r\n  const v = Number(value);\r\n  if (!Number.isFinite(v)) return 0;\r\n  let bestIdx = 0;\r\n  let bestDist = Infinity;\r\n  arr.forEach((a, i) => {\r\n    const d = Math.abs(a - v);\r\n    if (d < bestDist) {\r\n      bestDist = d;\r\n      bestIdx = i;\r\n    }\r\n  });\r\n  return bestIdx;\r\n}\r\n\r\n/**\r\n * Look up f_iv for PM using nearest neighbour in the table.\r\n *\r\n * @param {string} vehicleClassKey - one of pmFiv.vehicle_classes keys\r\n * @param {number} speedKmh        - speed in km/h\r\n * @param {number} gradePercent    - longitudinal grade in %\r\n */\r\nexport function getFivPM(vehicleClassKey, speedKmh, gradePercent) {\r\n  const cls = pmFiv.vehicle_classes[vehicleClassKey];\r\n  if (!cls) {\r\n    throw new Error(`Unknown PM vehicle class key: ${vehicleClassKey}`);\r\n  }\r\n\r\n  const r = nearestIndex(speeds, speedKmh);\r\n  const c = nearestIndex(grades, gradePercent);\r\n\r\n  return cls.fiv_table[r][c];\r\n}\r\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,iCAAiC;;AAEnD;AACA,OAAO,MAAMC,aAAa,GAAG,CAC3B;EACEC,EAAE,EAAE,GAAG;EACPC,OAAO,EAAE,oBAAoB;EAC7BC,OAAO,EAAE;AACX,CAAC,EACD;EACEF,EAAE,EAAE,GAAG;EACPC,OAAO,EAAE,kBAAkB;EAC3BC,OAAO,EAAE;AACX,CAAC,EACD;EACEF,EAAE,EAAE,GAAG;EACPC,OAAO,EAAE,iBAAiB;EAC1BC,OAAO,EAAE;AACX,CAAC,EACD;EACEF,EAAE,EAAE,GAAG;EACPC,OAAO,EAAE,2BAA2B;EACpCC,OAAO,EAAE;AACX,CAAC,CACF;AAED,MAAMC,MAAM,GAAGL,KAAK,CAACM,QAAQ,CAACC,UAAU,CAAC,CAAS;AAClD,MAAMC,MAAM,GAAGR,KAAK,CAACM,QAAQ,CAACG,cAAc,CAAC,CAAK;;AAElD,SAASC,YAAYA,CAACC,GAAG,EAAEC,KAAK,EAAE;EAChC,MAAMC,CAAC,GAAGC,MAAM,CAACF,KAAK,CAAC;EACvB,IAAI,CAACE,MAAM,CAACC,QAAQ,CAACF,CAAC,CAAC,EAAE,OAAO,CAAC;EACjC,IAAIG,OAAO,GAAG,CAAC;EACf,IAAIC,QAAQ,GAAGC,QAAQ;EACvBP,GAAG,CAACQ,OAAO,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;IACpB,MAAMC,CAAC,GAAGC,IAAI,CAACC,GAAG,CAACJ,CAAC,GAAGP,CAAC,CAAC;IACzB,IAAIS,CAAC,GAAGL,QAAQ,EAAE;MAChBA,QAAQ,GAAGK,CAAC;MACZN,OAAO,GAAGK,CAAC;IACb;EACF,CAAC,CAAC;EACF,OAAOL,OAAO;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASS,QAAQA,CAACC,eAAe,EAAEC,QAAQ,EAAEC,YAAY,EAAE;EAChE,MAAMC,GAAG,GAAG7B,KAAK,CAAC8B,eAAe,CAACJ,eAAe,CAAC;EAClD,IAAI,CAACG,GAAG,EAAE;IACR,MAAM,IAAIE,KAAK,CAAC,iCAAiCL,eAAe,EAAE,CAAC;EACrE;EAEA,MAAMM,CAAC,GAAGtB,YAAY,CAACL,MAAM,EAAEsB,QAAQ,CAAC;EACxC,MAAMM,CAAC,GAAGvB,YAAY,CAACF,MAAM,EAAEoB,YAAY,CAAC;EAE5C,OAAOC,GAAG,CAACK,SAAS,CAACF,CAAC,CAAC,CAACC,CAAC,CAAC;AAC5B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}