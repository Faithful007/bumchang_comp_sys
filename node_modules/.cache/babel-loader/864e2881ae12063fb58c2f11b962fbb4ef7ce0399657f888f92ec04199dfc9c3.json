{"ast":null,"code":"// src/modules/trafficEstimation/calculations.js\n\n// Excel logic: passenger cars split 60% gasoline / 40% diesel\nexport const PASSENGER_SPLIT = {\n  gasoline: 0.6,\n  diesel: 0.4\n};\n\n// Order aligned with Excel columns (C..J)\nexport const VEHICLE_KEYS = [\"passengerGasoline\",\n// C (휘발유)\n\"passengerDiesel\",\n// D (경유)\n\"busSmall\",\n// E (소형 버스)\n\"busLarge\",\n// F (대형 버스)\n\"truckSmall\",\n// G (소형 트럭)\n\"truckMedium\",\n// H (중형 트럭)\n\"truckLarge\",\n// I (대형 트럭)\n\"truckSpecial\" // J (특수)\n];\n\n/**\r\n * Compute estimated daily traffic (추정교통량 / 정교통량)\r\n * based on your sheet1 formulas.\r\n *\r\n * @param {{\r\n *   passengerAADT: number,\r\n *   busSmall: number,\r\n *   busLarge: number,\r\n *   truckSmall: number,\r\n *   truckMedium: number,\r\n *   truckLarge: number,\r\n *   truckSpecial: number\r\n * }} params\r\n */\nexport function computeEstimatedTraffic(params) {\n  const {\n    passengerAADT = 0,\n    busSmall = 0,\n    busLarge = 0,\n    truckSmall = 0,\n    truckMedium = 0,\n    truckLarge = 0,\n    truckSpecial = 0\n  } = params;\n\n  // 1) Counts (row 38 / 55 equivalents)\n  const counts = {\n    passengerGasoline: passengerAADT * PASSENGER_SPLIT.gasoline,\n    passengerDiesel: passengerAADT * PASSENGER_SPLIT.diesel,\n    busSmall,\n    busLarge,\n    truckSmall,\n    truckMedium,\n    truckLarge,\n    truckSpecial\n  };\n\n  // 2) Total AADT (K38 / K55)\n  const totalAadt = VEHICLE_KEYS.reduce((sum, key) => sum + (Number(counts[key]) || 0), 0);\n\n  // 3) Mix ratios (%) per vehicle type (C39..J39)\n  const mixPercents = {};\n  if (totalAadt > 0) {\n    VEHICLE_KEYS.forEach(key => {\n      const v = Number(counts[key]) || 0;\n      mixPercents[key] = Number((v / totalAadt * 100).toFixed(2));\n    });\n  } else {\n    VEHICLE_KEYS.forEach(key => {\n      mixPercents[key] = 0;\n    });\n  }\n\n  // 4) Heavy-vehicle mix Pt = F39 + H39 + I39 + J39\n  const heavyVehicleMixPt = Number(((mixPercents.busLarge || 0) + (mixPercents.truckMedium || 0) + (mixPercents.truckLarge || 0) + (mixPercents.truckSpecial || 0)).toFixed(2));\n\n  // 5) Sum of mix (%) – for check (should be ~100)\n  const mixPercentSum = VEHICLE_KEYS.reduce((sum, key) => sum + (mixPercents[key] || 0), 0);\n  return {\n    counts,\n    // per-category daily counts\n    totalAadt,\n    // K38/K55\n    mixPercents,\n    // per-category mix %\n    mixPercentSum,\n    // ~100\n    heavyVehicleMixPt // Pt (%)\n  };\n}\n\n// // src/modules/trafficEstimation/calculations.js\n\n// // Excel: 경유 승용차 교통량은 승용차 전체의 40%, 휘발유는 60%\n// export const PASSENGER_SPLIT = {\n//   gasoline: 0.6,\n//   diesel: 0.4\n// };\n\n// // Order matches Excel columns: C..J\n// export const VEHICLE_KEYS = [\n//   \"passengerGasoline\", // C (휘발유)\n//   \"passengerDiesel\",   // D (경유)\n//   \"busSmall\",          // E (소형 버스)\n//   \"busLarge\",          // F (대형 버스)\n//   \"truckSmall\",        // G (소형 트럭)\n//   \"truckMedium\",       // H (중형 트럭)\n//   \"truckLarge\",        // I (대형 트럭)\n//   \"truckSpecial\"       // J (특수)\n// ];\n\n// /**\n//  * Compute estimated daily traffic (정교통량 / 추정교통량)\n//  * using the same formulas as the Excel sheet.\n//  *\n//  * @param {{\n//  *   passengerAADT: number,\n//  *   busSmall: number,\n//  *   busLarge: number,\n//  *   truckSmall: number,\n//  *   truckMedium: number,\n//  *   truckLarge: number,\n//  *   truckSpecial: number\n//  * }} params\n//  */\n// export function computeEstimatedTraffic(params) {\n//   const {\n//     passengerAADT = 0,\n//     busSmall = 0,\n//     busLarge = 0,\n//     truckSmall = 0,\n//     truckMedium = 0,\n//     truckLarge = 0,\n//     truckSpecial = 0\n//   } = params;\n\n//   // 1) Counts (row 38 / 55)\n//   const counts = {\n//     passengerGasoline: passengerAADT * PASSENGER_SPLIT.gasoline, // C = I * 0.6\n//     passengerDiesel: passengerAADT * PASSENGER_SPLIT.diesel,     // D = I * 0.4\n//     busSmall,                                                    // E\n//     busLarge,                                                    // F\n//     truckSmall,                                                  // G\n//     truckMedium,                                                 // H\n//     truckLarge,                                                  // I\n//     truckSpecial                                                 // J\n//   };\n\n//   // 2) Total AADT (K38 / K55)\n//   const totalAadt = VEHICLE_KEYS.reduce(\n//     (sum, key) => sum + (Number(counts[key]) || 0),\n//     0\n//   );\n\n//   // 3) Mix ratios (C39..J39 etc.)\n//   const mixPercents = {};\n//   if (totalAadt > 0) {\n//     VEHICLE_KEYS.forEach((key) => {\n//       const v = Number(counts[key]) || 0;\n//       mixPercents[key] = Number(((v / totalAadt) * 100).toFixed(2)); // ROUND(...,2)\n//     });\n//   } else {\n//     VEHICLE_KEYS.forEach((key) => {\n//       mixPercents[key] = 0;\n//     });\n//   }\n\n//   // 4) Heavy-vehicle mix Pt (L39 / L56)\n//   //   Pt = 버스대형(F) + 트럭중(H) + 트럭대(I) + 특수(J)\n//   const heavyVehicleMixPt = Number(\n//     (\n//       (mixPercents.busLarge || 0) +\n//       (mixPercents.truckMedium || 0) +\n//       (mixPercents.truckLarge || 0) +\n//       (mixPercents.truckSpecial || 0)\n//     ).toFixed(2)\n//   );\n\n//   // 5) For completeness: sum of mix % (K39 should be ~100)\n//   const mixPercentSum = VEHICLE_KEYS.reduce(\n//     (sum, key) => sum + (mixPercents[key] || 0),\n//     0\n//   );\n\n//   return {\n//     counts,            // per-category daily counts (대/일)\n//     totalAadt,         // total daily traffic (K38/K55)\n//     mixPercents,       // per-category mix (%)\n//     mixPercentSum,     // should be 100\n//     heavyVehicleMixPt  // Pt (%)\n//   };\n// }","map":{"version":3,"names":["PASSENGER_SPLIT","gasoline","diesel","VEHICLE_KEYS","computeEstimatedTraffic","params","passengerAADT","busSmall","busLarge","truckSmall","truckMedium","truckLarge","truckSpecial","counts","passengerGasoline","passengerDiesel","totalAadt","reduce","sum","key","Number","mixPercents","forEach","v","toFixed","heavyVehicleMixPt","mixPercentSum"],"sources":["C:/Users/USER/sourcecodes/auto-excel/comp-engine/src/modules/trafficEstimation/calculations.js"],"sourcesContent":["// src/modules/trafficEstimation/calculations.js\r\n\r\n// Excel logic: passenger cars split 60% gasoline / 40% diesel\r\nexport const PASSENGER_SPLIT = {\r\n  gasoline: 0.6,\r\n  diesel: 0.4\r\n};\r\n\r\n// Order aligned with Excel columns (C..J)\r\nexport const VEHICLE_KEYS = [\r\n  \"passengerGasoline\", // C (휘발유)\r\n  \"passengerDiesel\",   // D (경유)\r\n  \"busSmall\",          // E (소형 버스)\r\n  \"busLarge\",          // F (대형 버스)\r\n  \"truckSmall\",        // G (소형 트럭)\r\n  \"truckMedium\",       // H (중형 트럭)\r\n  \"truckLarge\",        // I (대형 트럭)\r\n  \"truckSpecial\"       // J (특수)\r\n];\r\n\r\n/**\r\n * Compute estimated daily traffic (추정교통량 / 정교통량)\r\n * based on your sheet1 formulas.\r\n *\r\n * @param {{\r\n *   passengerAADT: number,\r\n *   busSmall: number,\r\n *   busLarge: number,\r\n *   truckSmall: number,\r\n *   truckMedium: number,\r\n *   truckLarge: number,\r\n *   truckSpecial: number\r\n * }} params\r\n */\r\nexport function computeEstimatedTraffic(params) {\r\n  const {\r\n    passengerAADT = 0,\r\n    busSmall = 0,\r\n    busLarge = 0,\r\n    truckSmall = 0,\r\n    truckMedium = 0,\r\n    truckLarge = 0,\r\n    truckSpecial = 0\r\n  } = params;\r\n\r\n  // 1) Counts (row 38 / 55 equivalents)\r\n  const counts = {\r\n    passengerGasoline: passengerAADT * PASSENGER_SPLIT.gasoline,\r\n    passengerDiesel: passengerAADT * PASSENGER_SPLIT.diesel,\r\n    busSmall,\r\n    busLarge,\r\n    truckSmall,\r\n    truckMedium,\r\n    truckLarge,\r\n    truckSpecial\r\n  };\r\n\r\n  // 2) Total AADT (K38 / K55)\r\n  const totalAadt = VEHICLE_KEYS.reduce(\r\n    (sum, key) => sum + (Number(counts[key]) || 0),\r\n    0\r\n  );\r\n\r\n  // 3) Mix ratios (%) per vehicle type (C39..J39)\r\n  const mixPercents = {};\r\n  if (totalAadt > 0) {\r\n    VEHICLE_KEYS.forEach((key) => {\r\n      const v = Number(counts[key]) || 0;\r\n      mixPercents[key] = Number(((v / totalAadt) * 100).toFixed(2));\r\n    });\r\n  } else {\r\n    VEHICLE_KEYS.forEach((key) => {\r\n      mixPercents[key] = 0;\r\n    });\r\n  }\r\n\r\n  // 4) Heavy-vehicle mix Pt = F39 + H39 + I39 + J39\r\n  const heavyVehicleMixPt = Number(\r\n    (\r\n      (mixPercents.busLarge || 0) +\r\n      (mixPercents.truckMedium || 0) +\r\n      (mixPercents.truckLarge || 0) +\r\n      (mixPercents.truckSpecial || 0)\r\n    ).toFixed(2)\r\n  );\r\n\r\n  // 5) Sum of mix (%) – for check (should be ~100)\r\n  const mixPercentSum = VEHICLE_KEYS.reduce(\r\n    (sum, key) => sum + (mixPercents[key] || 0),\r\n    0\r\n  );\r\n\r\n  return {\r\n    counts,            // per-category daily counts\r\n    totalAadt,         // K38/K55\r\n    mixPercents,       // per-category mix %\r\n    mixPercentSum,     // ~100\r\n    heavyVehicleMixPt  // Pt (%)\r\n  };\r\n}\r\n\r\n\r\n// // src/modules/trafficEstimation/calculations.js\r\n\r\n// // Excel: 경유 승용차 교통량은 승용차 전체의 40%, 휘발유는 60%\r\n// export const PASSENGER_SPLIT = {\r\n//   gasoline: 0.6,\r\n//   diesel: 0.4\r\n// };\r\n\r\n// // Order matches Excel columns: C..J\r\n// export const VEHICLE_KEYS = [\r\n//   \"passengerGasoline\", // C (휘발유)\r\n//   \"passengerDiesel\",   // D (경유)\r\n//   \"busSmall\",          // E (소형 버스)\r\n//   \"busLarge\",          // F (대형 버스)\r\n//   \"truckSmall\",        // G (소형 트럭)\r\n//   \"truckMedium\",       // H (중형 트럭)\r\n//   \"truckLarge\",        // I (대형 트럭)\r\n//   \"truckSpecial\"       // J (특수)\r\n// ];\r\n\r\n// /**\r\n//  * Compute estimated daily traffic (정교통량 / 추정교통량)\r\n//  * using the same formulas as the Excel sheet.\r\n//  *\r\n//  * @param {{\r\n//  *   passengerAADT: number,\r\n//  *   busSmall: number,\r\n//  *   busLarge: number,\r\n//  *   truckSmall: number,\r\n//  *   truckMedium: number,\r\n//  *   truckLarge: number,\r\n//  *   truckSpecial: number\r\n//  * }} params\r\n//  */\r\n// export function computeEstimatedTraffic(params) {\r\n//   const {\r\n//     passengerAADT = 0,\r\n//     busSmall = 0,\r\n//     busLarge = 0,\r\n//     truckSmall = 0,\r\n//     truckMedium = 0,\r\n//     truckLarge = 0,\r\n//     truckSpecial = 0\r\n//   } = params;\r\n\r\n//   // 1) Counts (row 38 / 55)\r\n//   const counts = {\r\n//     passengerGasoline: passengerAADT * PASSENGER_SPLIT.gasoline, // C = I * 0.6\r\n//     passengerDiesel: passengerAADT * PASSENGER_SPLIT.diesel,     // D = I * 0.4\r\n//     busSmall,                                                    // E\r\n//     busLarge,                                                    // F\r\n//     truckSmall,                                                  // G\r\n//     truckMedium,                                                 // H\r\n//     truckLarge,                                                  // I\r\n//     truckSpecial                                                 // J\r\n//   };\r\n\r\n//   // 2) Total AADT (K38 / K55)\r\n//   const totalAadt = VEHICLE_KEYS.reduce(\r\n//     (sum, key) => sum + (Number(counts[key]) || 0),\r\n//     0\r\n//   );\r\n\r\n//   // 3) Mix ratios (C39..J39 etc.)\r\n//   const mixPercents = {};\r\n//   if (totalAadt > 0) {\r\n//     VEHICLE_KEYS.forEach((key) => {\r\n//       const v = Number(counts[key]) || 0;\r\n//       mixPercents[key] = Number(((v / totalAadt) * 100).toFixed(2)); // ROUND(...,2)\r\n//     });\r\n//   } else {\r\n//     VEHICLE_KEYS.forEach((key) => {\r\n//       mixPercents[key] = 0;\r\n//     });\r\n//   }\r\n\r\n//   // 4) Heavy-vehicle mix Pt (L39 / L56)\r\n//   //   Pt = 버스대형(F) + 트럭중(H) + 트럭대(I) + 특수(J)\r\n//   const heavyVehicleMixPt = Number(\r\n//     (\r\n//       (mixPercents.busLarge || 0) +\r\n//       (mixPercents.truckMedium || 0) +\r\n//       (mixPercents.truckLarge || 0) +\r\n//       (mixPercents.truckSpecial || 0)\r\n//     ).toFixed(2)\r\n//   );\r\n\r\n//   // 5) For completeness: sum of mix % (K39 should be ~100)\r\n//   const mixPercentSum = VEHICLE_KEYS.reduce(\r\n//     (sum, key) => sum + (mixPercents[key] || 0),\r\n//     0\r\n//   );\r\n\r\n//   return {\r\n//     counts,            // per-category daily counts (대/일)\r\n//     totalAadt,         // total daily traffic (K38/K55)\r\n//     mixPercents,       // per-category mix (%)\r\n//     mixPercentSum,     // should be 100\r\n//     heavyVehicleMixPt  // Pt (%)\r\n//   };\r\n// }\r\n"],"mappings":"AAAA;;AAEA;AACA,OAAO,MAAMA,eAAe,GAAG;EAC7BC,QAAQ,EAAE,GAAG;EACbC,MAAM,EAAE;AACV,CAAC;;AAED;AACA,OAAO,MAAMC,YAAY,GAAG,CAC1B,mBAAmB;AAAE;AACrB,iBAAiB;AAAI;AACrB,UAAU;AAAW;AACrB,UAAU;AAAW;AACrB,YAAY;AAAS;AACrB,aAAa;AAAQ;AACrB,YAAY;AAAS;AACrB,cAAc,CAAO;AAAA,CACtB;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,uBAAuBA,CAACC,MAAM,EAAE;EAC9C,MAAM;IACJC,aAAa,GAAG,CAAC;IACjBC,QAAQ,GAAG,CAAC;IACZC,QAAQ,GAAG,CAAC;IACZC,UAAU,GAAG,CAAC;IACdC,WAAW,GAAG,CAAC;IACfC,UAAU,GAAG,CAAC;IACdC,YAAY,GAAG;EACjB,CAAC,GAAGP,MAAM;;EAEV;EACA,MAAMQ,MAAM,GAAG;IACbC,iBAAiB,EAAER,aAAa,GAAGN,eAAe,CAACC,QAAQ;IAC3Dc,eAAe,EAAET,aAAa,GAAGN,eAAe,CAACE,MAAM;IACvDK,QAAQ;IACRC,QAAQ;IACRC,UAAU;IACVC,WAAW;IACXC,UAAU;IACVC;EACF,CAAC;;EAED;EACA,MAAMI,SAAS,GAAGb,YAAY,CAACc,MAAM,CACnC,CAACC,GAAG,EAAEC,GAAG,KAAKD,GAAG,IAAIE,MAAM,CAACP,MAAM,CAACM,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,EAC9C,CACF,CAAC;;EAED;EACA,MAAME,WAAW,GAAG,CAAC,CAAC;EACtB,IAAIL,SAAS,GAAG,CAAC,EAAE;IACjBb,YAAY,CAACmB,OAAO,CAAEH,GAAG,IAAK;MAC5B,MAAMI,CAAC,GAAGH,MAAM,CAACP,MAAM,CAACM,GAAG,CAAC,CAAC,IAAI,CAAC;MAClCE,WAAW,CAACF,GAAG,CAAC,GAAGC,MAAM,CAAC,CAAEG,CAAC,GAAGP,SAAS,GAAI,GAAG,EAAEQ,OAAO,CAAC,CAAC,CAAC,CAAC;IAC/D,CAAC,CAAC;EACJ,CAAC,MAAM;IACLrB,YAAY,CAACmB,OAAO,CAAEH,GAAG,IAAK;MAC5BE,WAAW,CAACF,GAAG,CAAC,GAAG,CAAC;IACtB,CAAC,CAAC;EACJ;;EAEA;EACA,MAAMM,iBAAiB,GAAGL,MAAM,CAC9B,CACE,CAACC,WAAW,CAACb,QAAQ,IAAI,CAAC,KACzBa,WAAW,CAACX,WAAW,IAAI,CAAC,CAAC,IAC7BW,WAAW,CAACV,UAAU,IAAI,CAAC,CAAC,IAC5BU,WAAW,CAACT,YAAY,IAAI,CAAC,CAAC,EAC/BY,OAAO,CAAC,CAAC,CACb,CAAC;;EAED;EACA,MAAME,aAAa,GAAGvB,YAAY,CAACc,MAAM,CACvC,CAACC,GAAG,EAAEC,GAAG,KAAKD,GAAG,IAAIG,WAAW,CAACF,GAAG,CAAC,IAAI,CAAC,CAAC,EAC3C,CACF,CAAC;EAED,OAAO;IACLN,MAAM;IAAa;IACnBG,SAAS;IAAU;IACnBK,WAAW;IAAQ;IACnBK,aAAa;IAAM;IACnBD,iBAAiB,CAAE;EACrB,CAAC;AACH;;AAGA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}